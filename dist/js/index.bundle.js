(()=>{"use strict";const e={feedback:document.querySelector(".feedback"),selectFeedback:document.querySelector(".select-feedback"),startDate:document.getElementById("start-date-search"),loader:document.querySelector(".loader-container"),endDate:document.getElementById("end-date-search"),dateForm:document.getElementById("asteroid-date"),asteroidList:document.querySelector(".asteroid-list"),table:document.querySelector(".asteroid-table"),tableBody:document.querySelector(".asteroid-info"),selectBox:document.getElementById("asteroids"),selectOption:document.querySelectorAll(".option-element"),nodeListItem:document.querySelectorAll(".list-item"),tableList:document.querySelector(".asteroid-info"),prevButton:document.getElementById("button-prev"),nextButton:document.getElementById("button-next"),asteroidsOption:document.getElementById("asteroids"),pageNumber:document.querySelector(".page-number"),chartContainer:document.querySelector(".chart-container"),loaderContainer:document.querySelector(".loader-container")};class t{constructor(){this.records_per_page=4}async asteroidDate(e,t){try{const a=`https://api.nasa.gov/neo/rest/v1/feed?start_date=${e}&end_date=${t}&api_key=x0HeIJzRCLm3lj0zrfXt2LltusKVCO7aoHmRkVq2`,s=await fetch(a);let o=(await s.json()).near_earth_objects;const r=Object.entries(o);let i=[],n=[];for(let[e,t]of r)i=t.filter((e=>!0===e.is_potentially_hazardous_asteroid)),i=i.map((t=>{const a=e,s=t.name;return{tableDate:a,astId:t.id,astName:s,astSpeed:t.close_approach_data[0].relative_velocity.kilometers_per_hour,minRadius:t.estimated_diameter.meters.estimated_diameter_min,maxRadius:t.estimated_diameter.meters.estimated_diameter_max}})),i.length&&n.push(i);const c=n.flat();return[c,Math.ceil(c.length/this.records_per_page)]}catch(e){throw console.log(e),e}}}class a{constructor(e){this.current_page=e,this.records_per_page=4,this.parentElement=document.querySelector(".loader-container")}showFeedback(e,t){t.classList.add("showItem"),t.innerHTML=`<p>${e}</p>`,setTimeout((()=>{t.classList.remove("showItem")}),3e3)}renderSpinner(){setTimeout((()=>{e.loaderContainer.classList.add("visible-loader")}),2e3)}prevPage(e,t){this.current_page=e,this.asteroidTable(t)}nextPage(e,t){this.current_page=e,this.asteroidTable(t)}pageNumbers(t){const a=t[1];e.pageNumber.innerHTML="";for(let t=1;t<a+1;t++)e.pageNumber.innerHTML+="<span class='clickPageNumber'>"+t+"</span>"}asteroidTable(t){const a=t[1],s=t[0];this.current_page<1&&(this.current_page=1),this.current_page>a-1&&(this.current_page=a),e.tableBody.innerHTML="";for(let t=(this.current_page-1)*this.records_per_page;t<this.current_page*this.records_per_page&&t<s.length;t++){const a=document.createElement("tr");a.classList.add("table-element"),a.innerHTML="",a.innerHTML=`\n              <td class="fly-date">${s[t].tableDate}</td>\n              <td class="name">${s[t].astName}</td>\n              <td class="speed">${s[t].astSpeed}</td>\n              <td class="min-radius">${s[t].minRadius}</td>\n              <td class="max-radius">${s[t].maxRadius}</td>`,e.tableBody.insertAdjacentElement("beforeend",a)}for(;e.selectBox.childNodes.length>2;)e.selectBox.removeChild(e.selectBox.lastChild);s.forEach((t=>{const a=document.createElement("option");a.classList.add("option-element"),a.value=t.astId,a.innerHTML=t.astName,e.selectBox.appendChild(a)})),e.startDate.value="",e.endDate.value=""}selectedPage(e,t){let a=document.querySelectorAll(".clickPageNumber"),s=t[1];for(let t=0;t<s;t++)a[t].style.opacity=t==e-1?"1.0":"0.5"}checkButtonOpacity(t,a){let s=a[1];1==t?(e.prevButton.classList.add("opacity"),e.nextButton.classList.remove("opacity")):t==s?e.nextButton.classList.add("opacity"):(e.prevButton.classList.remove("opacity"),e.nextButton.classList.remove("opacity"))}updateSelection(t){const a=t[0],s=t[1],o=t[2];a.forEach(((t,a)=>{const r=s[a],i=o[a],n=document.createElement("li");n.classList.add("list-item"),n.innerHTML=`<div class="asteroids-item" data-listIndex="${i}">${t}</div>\n                        <a href="#" class="delete-icon" data-id="${r}"\n                         ><i class="fas fa-times"> </i\n                          ></a>\n                       `,e.asteroidList.appendChild(n)}))}selectItems(t){const a=document.getElementsByTagName("option")[t].value,s=document.getElementsByTagName("option")[t].text,o=document.createElement("li");return o.classList.add("list-item"),o.innerHTML=`<div class="asteroids-item" data-listIndex="${t}">${s}</div>\n                      <a href="#" class="delete-icon" data-id="${a}"\n                       ><i class="fas fa-times"></i\n                        ></a>\n                     `,e.asteroidList.appendChild(o),[s,a]}removeItem(t,a){let s=[],o=[];document.querySelectorAll(".list-item").forEach((e=>{s.push(e.childNodes[0].innerHTML),o.push(e.childNodes[2].dataset.id)})),e.asteroidList.removeChild(a);return[s.indexOf(t)]}}class s{constructor(){this.optionArr=[],this.optionList=[],this.idList=[]}updateStorage(e){const t=e[0],a=e[1];localStorage.setItem("asteroidDataLocal",JSON.stringify(t)),localStorage.setItem("numOfPages",JSON.stringify(a))}getAsteroids(){return[JSON.parse(localStorage.getItem("asteroidDataLocal")),JSON.parse(localStorage.getItem("numOfPages"))]}loadedSelectList(){let e,t,a;return e=localStorage.getItem("idList")?JSON.parse(localStorage.getItem("idList")):[],t=localStorage.getItem("optionList")?JSON.parse(localStorage.getItem("optionList")):[],a=localStorage.getItem("optionArr")?JSON.parse(localStorage.getItem("optionArr")):[],[t,e,a]}setLocalStorage(e,t,a){localStorage.removeItem("idList"),localStorage.removeItem("optionList"),localStorage.removeItem("optionArr"),localStorage.setItem("idList",JSON.stringify(t)),localStorage.setItem("optionList",JSON.stringify(e)),localStorage.setItem("optionArr",JSON.stringify(a))}removeLocalStorage(){localStorage.removeItem("idList"),localStorage.removeItem("optionList"),localStorage.removeItem("optionArr")}saveCurrPage(e){localStorage.removeItem("currentPage"),localStorage.setItem("currentPage",JSON.stringify(e))}getCurrPage(){return JSON.parse(localStorage.getItem("currentPage"))}saveSelectList(e,t,a){[this.optionList,this.idList,this.optionArr]=this.loadedSelectList(),this.idList.push(t),this.optionList.push(e),this.optionArr.push(a),this.setLocalStorage(this.optionList,this.idList,this.optionArr)}removeSelectedItem(e){[this.optionList,this.idList,this.optionArr]=this.loadedSelectList(),this.optionList.splice(e,1),this.idList.splice(e,1),this.optionArr.splice(e,1),this.setLocalStorage(this.optionList,this.idList,this.optionArr)}}!function(){let o=1;const r=new t,i=new a(o),n=new s;e.loaderContainer.classList.remove("visible-loader"),e.dateForm.addEventListener("submit",(t=>{t.preventDefault(),e.loaderContainer.classList.remove("visible-loader"),["table-section","select-section"].forEach((function(e){document.getElementById(e).style.display="block"}));const a=e.startDate.value,s=e.endDate.value,o=Date.parse(a),c=(Date.parse(s)-o)/864e5;""===a&&""===s?i.showFeedback("Molimo Vas, unesite datum",e.feedback):c>7?i.showFeedback("Maksimalni period između dva datuma je 7 dana, molimo Vas unesite datume u skladu sa zahtevom",e.feedback):c<0?i.showFeedback("Početni datum mora biti pre završnog, molimo Vas unesite pravilno parametre",e.feedback):(e.asteroidList.innerHTML="",n.removeLocalStorage(),r.asteroidDate(a,s).then((e=>{i.renderSpinner(),i.asteroidTable(e),i.pageNumbers(e),n.updateStorage(e)})).catch((e=>console.log(e)))),i.renderSpinner()})),e.prevButton.addEventListener("click",(()=>{const e=n.getAsteroids();if(o>1){o--;const t=new a(o);t.prevPage(o,e),t.selectedPage(o,e),t.checkButtonOpacity(o,e),n.saveCurrPage(o)}})),e.nextButton.addEventListener("click",(()=>{const e=n.getAsteroids();if(o<e[1]){o++;const t=new a(o);t.nextPage(o,e),t.selectedPage(o,e),t.checkButtonOpacity(o,e),n.saveCurrPage(o)}})),document.addEventListener("click",(e=>{const t=n.getAsteroids();"SPAN"==e.target.nodeName&&e.target.classList.contains("clickPageNumber")&&(i.current_page=parseInt(e.target.textContent),i.selectedPage(i.current_page,t),i.checkButtonOpacity(i.current_page,t),i.asteroidTable(t),n.saveCurrPage(i.current_page))})),e.selectBox.addEventListener("change",(()=>{const t=localStorage.getItem("optionArr")?JSON.parse(localStorage.getItem("optionArr")):[];e.selectBox.options[0].disabled=!0;const a=e.selectBox.selectedIndex;if(t.includes(a))i.showFeedback("Asteroid koji ste izabrali vec postoji u izabranoj listi, molimo Vas izaberite drugi asteroid",e.selectFeedback);else{const[e,t]=i.selectItems(a);n.saveSelectList(e,t,a)}})),e.asteroidList.addEventListener("click",(function(e){e.preventDefault();const t=e.target.parentElement;if(t.classList.contains("delete-icon")){const a=t.previousElementSibling.innerHTML,s=e.target.parentElement.parentElement,o=i.removeItem(a,s);n.removeSelectedItem(o)}}),!1),document.addEventListener("DOMContentLoaded",(()=>{e.loaderContainer.classList.remove("visible-loader");null!==n.getAsteroids()[0]&&(i.current_page=n.getCurrPage(),o=n.getCurrPage(),i.pageNumbers(n.getAsteroids()),i.asteroidTable(n.getAsteroids()),i.selectedPage(o,n.getAsteroids()),i.checkButtonOpacity(o,n.getAsteroids()),i.updateSelection(n.loadedSelectList()),i.renderSpinner()),i.renderSpinner()}))}()})();
//# sourceMappingURL=index.bundle.js.map